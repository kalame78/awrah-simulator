<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Les PÃ©chÃ©s des Yeux - Fiche 8</title>
    
    <!-- On utilise Tailwind via CDN pour que le design fonctionne tout de suite sans installation -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Configuration des polices -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Inter:wght@300;400;500;600;700&display=swap');
        
        body { font-family: 'Inter', sans-serif; background-color: #f9fafb; }
        .font-amiri { font-family: 'Amiri', serif; }
        
        /* Animations douces */
        .fade-in { animation: fadeIn 0.4s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        .slide-up { animation: slideUp 0.3s cubic-bezier(0.16, 1, 0.3, 1); }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* Masquer la scrollbar pour un look clean */
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-thumb { background: #e5e7eb; border-radius: 10px; }

        /* Effet 3D pour la carte */
        .perspective-1000 { perspective: 1000px; }
        .transform-style-3d { transform-style: preserve-3d; }
        .backface-hidden { backface-visibility: hidden; }
        .rotate-y-180 { transform: rotateY(180deg); }
    </style>
</head>
<body class="text-gray-800 h-screen flex flex-col max-w-md mx-auto shadow-2xl overflow-hidden relative bg-gray-50">

    <!-- HEADER FIXE -->
    <header class="bg-white px-5 py-4 flex items-center gap-3 border-b border-gray-100 sticky top-0 z-10">
        <div class="bg-emerald-600 p-2 rounded-lg text-white">
            <!-- Icone Eye -->
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/></svg>
        </div>
        <div>
            <h1 class="text-xl font-bold text-gray-900 leading-tight">Les PÃ©chÃ©s des Yeux</h1>
            <p class="text-xs text-gray-500 font-medium tracking-wide">FICHE INTERACTIVE NÂ°8</p>
        </div>
    </header>

    <!-- CONTENU PRINCIPAL -->
    <main class="flex-1 overflow-y-auto p-4 space-y-6 pb-28" id="main-content">
        
        <!-- ONGLET 1: DEFINITIONS -->
        <div id="tab-definitions" class="space-y-6 fade-in">
            
            <!-- Carte DÃ©finition ComplÃ¨te -->
            <div class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
                <!-- En-tÃªte DÃ©gradÃ© -->
                <div class="bg-gradient-to-r from-[#8B5E3C] to-[#A67C52] p-3 text-center">
                    <h2 class="text-white font-bold tracking-widest uppercase text-sm shadow-sm">DÃ‰FINITION DE REGARDER L'INTERDIT</h2>
                </div>

                <div class="p-5">
                    <p class="text-gray-700 text-center text-sm leading-relaxed mb-4">
                        Il s'agit de regarder avec attention les parties du corps d'autrui qu'Allah a interdit de dÃ©voiler. On appelle ces parties du corps Â« awrah Â».
                    </p>

                    <!-- Texte Arabe -->
                    <div class="text-center mb-6">
                        <p class="font-amiri text-lg text-gray-800 leading-loose" dir="rtl">
                            Ù‡ÙÙˆÙ Ø§Ù„ØªÙ‘ÙØ£Ù’Ù…ÙÙ„Ù Ø¨ÙØ§Ù„Ù†Ù‘ÙØ¸ÙØ±Ù ÙÙÙŠ Ø§Ù„Ù’Ø¹ÙÙˆÙ’Ø±ÙØ§ØªÙ ÙˆÙÙ‡ÙÙŠÙ Ù…ÙØ§ ÙŠÙØ­Ù’Ø±ÙÙ…Ù ÙƒÙØ´Ù’ÙÙÙ‡Ù Ù…ÙÙ†Ù Ø§Ù„Ù’Ø¬ÙØ³Ù’Ù…Ù Ø³ÙÙˆÙØ§Ø¡ÙŒ Ù…ÙÙ†Ù Ø§Ù„Ø±Ù‘ÙØ¬ÙÙ„Ù Ø£ÙÙˆÙ Ø§Ù„Ù’Ù…ÙØ±Ù’Ø£ÙØ©Ù
                        </p>
                    </div>

                    <!-- Bloc Condition (Beige) -->
                    <div class="bg-[#FDF6E3] rounded-xl border border-[#E8DCC2] overflow-hidden">
                        <div class="bg-[#EFE5D1] py-2 px-3 text-center border-b border-[#E8DCC2]">
                            <h3 class="text-[#8B5E3C] font-bold text-[10px] sm:text-xs uppercase tracking-wide">
                                CELA N'EST INTERDIT QUE SI ON A L'INTENTION DE REGARDER LA 'AWRAH
                            </h3>
                        </div>
                        
                        <div class="p-4 text-center">
                            <p class="text-xs text-gray-600 mb-3 italic">
                                Dans les Sunan de 'Abi DÄwÅ«d, d'aprÃ¨s 'Ali ibn 'Abi TÄlib, le ProphÃ¨te ï·º dit :
                            </p>
                            
                            <p class="font-amiri text-lg text-gray-800 mb-2 leading-loose" dir="rtl">
                                ÙŠÙØ§ Ø¹ÙÙ„ÙÙŠÙÙ‘ØŒ Ù„Ø§ ØªÙØªÙ’Ø¨ÙØ¹Ù Ø§Ù„Ù†ÙÙ‘Ø¸Ù’Ø±ÙØ©Ù Ø§Ù„Ù†ÙÙ‘Ø¸Ù’Ø±ÙØ©Ù ØŒ ÙÙØ¥ÙÙ†Ù‘Ù Ù„ÙÙƒÙ Ø§Ù„Ù’Ø£ÙÙˆÙ„ÙÙ‰ ÙˆÙÙ„ÙÙŠÙ’Ø³ÙØªÙ’ Ù„ÙÙƒÙ Ø§Ù„Ù’Ø¢Ø®ÙØ±ÙØ©Ù
                            </p>

                            <p class="text-gray-800 font-medium text-sm italic relative px-2 mt-2">
                                <span class="text-[#A67C52] text-2xl absolute -top-2 left-0 opacity-50">â€œ</span>
                                Ã” Ali, ne fais pas suivre le premier regard par le suivant, car tu as droit au premier, mais pas au second.
                                <span class="text-[#A67C52] text-2xl absolute -bottom-4 right-0 opacity-50">â€</span>
                            </p>
                        </div>
                    </div>

                    <div class="mt-6 pt-4 border-t border-gray-100 text-xs text-gray-500 text-center">
                        <span class="font-bold block text-gray-400 uppercase text-[10px] mb-1">Note (Al-Akhdari)</span>
                        Â« Il lui est obligatoire de prÃ©server ses yeux de regarder l'interdit... Â»
                    </div>
                </div>
            </div>

            <!-- Carte Preuves (Vert FoncÃ©) -->
            <div class="bg-emerald-900 rounded-2xl p-6 shadow-md text-white">
                <div class="flex items-center gap-2 mb-6">
                    <svg class="text-emerald-300" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>
                    <h2 class="text-xl font-serif font-bold text-white">Preuves de l'Interdiction</h2>
                </div>
                
                <div class="grid gap-6">
                    <!-- Hommes -->
                    <div class="bg-emerald-800/50 rounded-xl p-4 border border-emerald-700/50">
                        <h3 class="text-emerald-200 font-bold text-sm mb-3 uppercase tracking-wider">Pour les Hommes (S. An-Nur, v.30)</h3>
                        <p class="text-right font-amiri text-xl leading-loose mb-3" dir="rtl">
                            Ù‚ÙÙ„ Ù„Ù‘ÙÙ„Ù’Ù…ÙØ¤Ù’Ù…ÙÙ†ÙÙŠÙ†Ù ÙŠÙØºÙØ¶Ù‘ÙÙˆØ§ Ù…ÙÙ†Ù’ Ø£ÙØ¨Ù’ØµÙØ§Ø±ÙÙ‡ÙÙ…Ù’ ÙˆÙÙŠÙØ­Ù’ÙÙØ¸ÙÙˆØ§ ÙÙØ±ÙÙˆØ¬ÙÙ‡ÙÙ…Ù’
                        </p>
                        <p class="text-emerald-100 text-sm italic leading-relaxed">
                            Â« Dis aux croyants de baisser leurs regards et de prÃ©server leurs parties intimes ; ceci est plus pur pour eux. Â»
                        </p>
                    </div>

                    <!-- Femmes -->
                    <div class="bg-emerald-800/50 rounded-xl p-4 border border-emerald-700/50">
                        <h3 class="text-emerald-200 font-bold text-sm mb-3 uppercase tracking-wider">Pour les Femmes (S. An-Nur, v.31)</h3>
                        <p class="text-right font-amiri text-xl leading-loose mb-3" dir="rtl">
                            ÙˆÙÙ‚ÙÙ„ Ù„Ù‘ÙÙ„Ù’Ù…ÙØ¤Ù’Ù…ÙÙ†ÙØ§ØªÙ ÙŠÙØºÙ’Ø¶ÙØ¶Ù’Ù†Ù Ù…ÙÙ†Ù’ Ø£ÙØ¨Ù’ØµÙØ§Ø±ÙÙ‡ÙÙ†Ù‘Ù ÙˆÙÙŠÙØ­Ù’ÙÙØ¸Ù’Ù†Ù ÙÙØ±ÙÙˆØ¬ÙÙ‡ÙÙ†Ù‘Ù
                        </p>
                        <p class="text-emerald-100 text-sm italic leading-relaxed">
                            Â« Dis aux croyantes de baisser leur regard et de prÃ©server leurs parties intimes. Â»
                        </p>
                    </div>
                </div>
            </div>

            <!-- Carte Mahram/Ajnabi -->
            <div class="bg-white rounded-2xl p-5 shadow-sm border border-gray-100">
                <h2 class="text-lg font-bold text-gray-800 mb-4">Les CatÃ©gories de Personnes</h2>
                <div class="space-y-4">
                    <!-- Mahram -->
                    <div class="p-4 bg-blue-50 rounded-xl border border-blue-100">
                        <div class="flex items-center gap-3 mb-2">
                            <div class="bg-blue-100 text-blue-600 rounded-full p-2">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
                            </div>
                            <span class="font-bold text-blue-900 text-lg">Le Mahram</span>
                        </div>
                        <p class="text-sm text-blue-800 leading-relaxed pl-1">
                            Personne avec qui le mariage est <strong>interdit Ã  vie</strong> (PÃ¨re, frÃ¨re, oncle, fils...).
                        </p>
                    </div>

                    <!-- Ajnabi -->
                    <div class="p-4 bg-purple-50 rounded-xl border border-purple-100">
                        <div class="flex items-center gap-3 mb-2">
                            <div class="bg-purple-100 text-purple-600 rounded-full p-2">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
                            </div>
                            <span class="font-bold text-purple-900 text-lg">L'Ajnabi (Ã‰tranger)</span>
                        </div>
                        <p class="text-sm text-purple-800 leading-relaxed pl-1">
                            Toute personne avec qui le mariage est <strong>possible</strong> (Cousin(e), voisin(e), inconnu(e)).
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- ONGLET 2: SIMULATEUR -->
        <div id="tab-simulateur" class="hidden fade-in space-y-4">
            <div class="bg-white p-5 rounded-2xl shadow-sm border border-gray-100">
                <h2 class="text-lg font-bold text-gray-800 mb-1">Simulateur Awrah</h2>
                <p class="text-gray-500 text-xs mb-6">Configurez la situation pour voir les rÃ¨gles.</p>

                <div class="space-y-5">
                    <!-- Je Suis -->
                    <div>
                        <span class="text-xs font-bold text-gray-400 uppercase tracking-wider mb-2 block">Je suis</span>
                        <div class="flex gap-2">
                            <button onclick="updateSim('subject', 'homme')" id="btn-sub-homme" class="sim-btn flex-1 py-2 px-3 text-sm rounded-lg border font-medium bg-emerald-600 text-white border-emerald-600">Un Homme</button>
                            <button onclick="updateSim('subject', 'femme')" id="btn-sub-femme" class="sim-btn flex-1 py-2 px-3 text-sm rounded-lg border font-medium bg-white text-gray-500 border-gray-200">Une Femme</button>
                        </div>
                    </div>
                    <!-- Je Regarde -->
                    <div>
                        <span class="text-xs font-bold text-gray-400 uppercase tracking-wider mb-2 block">Je regarde</span>
                        <div class="flex gap-2">
                            <button onclick="updateSim('target', 'homme')" id="btn-tar-homme" class="sim-btn flex-1 py-2 px-3 text-sm rounded-lg border font-medium bg-emerald-600 text-white border-emerald-600">Un Homme</button>
                            <button onclick="updateSim('target', 'femme')" id="btn-tar-femme" class="sim-btn flex-1 py-2 px-3 text-sm rounded-lg border font-medium bg-white text-gray-500 border-gray-200">Une Femme</button>
                        </div>
                    </div>
                    <!-- Relation -->
                    <div>
                        <span class="text-xs font-bold text-gray-400 uppercase tracking-wider mb-2 block">Relation</span>
                        <div class="flex gap-2">
                            <button onclick="updateSim('relation', 'ajnabi')" id="btn-rel-ajnabi" class="sim-btn flex-1 py-2 px-3 text-sm rounded-lg border font-medium bg-emerald-600 text-white border-emerald-600">Inconnu(e)</button>
                            <button onclick="updateSim('relation', 'mahram')" id="btn-rel-mahram" class="sim-btn flex-1 py-2 px-3 text-sm rounded-lg border font-medium bg-white text-gray-500 border-gray-200">Mahram</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- RÃ©sultat -->
            <div id="sim-result-box" class="p-5 rounded-2xl border bg-emerald-50 text-emerald-800 border-emerald-200 shadow-sm flex items-start gap-3">
                <div class="mt-1" id="sim-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
                </div>
                <div>
                    <h3 class="font-bold mb-1">Verdict :</h3>
                    <p class="text-sm leading-relaxed" id="sim-text">Entre hommes : La 'Awrah est situÃ©e entre le nombril et les genoux.</p>
                </div>
            </div>

            <div class="bg-blue-50 p-4 rounded-xl border border-blue-100">
               <p class="text-xs text-blue-800 text-center">
                   <span class="font-bold">Astuce :</span> Les cousins/cousines ne sont PAS des Mahrams.
               </p>
            </div>
        </div>

        <!-- ONGLET 3: MAUVAIS OEIL -->
        <div id="tab-mauvais-oeil" class="hidden fade-in space-y-4">
            <!-- Accueil Mauvais Oeil -->
            <div id="mo-step-0" class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100 text-center space-y-6">
                <div class="w-20 h-20 bg-indigo-50 rounded-full flex items-center justify-center mx-auto text-4xl">ğŸ§¿</div>
                <div>
                    <h2 class="text-xl font-bold text-gray-800">Le Mauvais Å’il (Al-Ayn)</h2>
                    <p class="text-gray-500 text-sm mt-2">Un regard admiratif qui peut nuire s'il n'est pas bÃ©ni.</p>
                </div>
                <div class="grid gap-3">
                    <button onclick="showMoStep(1)" class="w-full bg-emerald-600 text-white py-3 rounded-xl font-medium shadow-lg shadow-emerald-200">Comment se protÃ©ger ?</button>
                    <button onclick="showMoStep(2)" class="w-full bg-white border border-gray-200 text-gray-700 py-3 rounded-xl font-medium">Le RemÃ¨de (Lavage)</button>
                </div>
            </div>

            <!-- Protection -->
            <div id="mo-step-1" class="hidden bg-white p-6 rounded-2xl shadow-sm border border-gray-100 text-center relative">
                <button onclick="showMoStep(0)" class="absolute top-4 left-4 text-gray-400 font-bold text-xl">&larr;</button>
                <h3 class="font-bold text-lg mb-4">La RÃ¨gle d'Or</h3>
                <p class="text-gray-600 mb-6">DÃ¨s que quelque chose te plaÃ®t chez autrui, tu DOIS invoquer la bÃ©nÃ©diction.</p>
                <div class="bg-yellow-50 border border-yellow-200 p-4 rounded-xl mb-6">
                    <p class="font-amiri text-2xl text-yellow-800 mb-2">Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ Ø¨ÙØ§Ø±ÙÙƒÙ’ ÙÙÙŠÙ‡Ù</p>
                    <p class="font-bold text-yellow-900">"Allahumma Barik Fih"</p>
                    <p class="text-xs text-yellow-700 mt-1">(Ã” Allah, bÃ©nis-le)</p>
                </div>
            </div>

            <!-- Lavage -->
            <div id="mo-step-2" class="hidden bg-white p-6 rounded-2xl shadow-sm border border-gray-100">
                <div class="flex justify-between items-center mb-6">
                     <h3 class="font-bold text-lg">Rituel de Lavage</h3>
                     <button onclick="showMoStep(0)" class="text-gray-400 bg-gray-50 p-1 rounded-full px-3 font-bold">X</button>
                </div>
                <div class="bg-blue-50 p-6 rounded-2xl text-center mb-6 min-h-[160px] flex flex-col items-center justify-center relative">
                    <div class="absolute top-2 right-2 text-xs font-bold text-blue-300" id="wash-count">1/8</div>
                    <p class="text-blue-900 font-medium text-lg leading-relaxed" id="wash-text">Se rincer la bouche (Madmadah) et recracher dans le bol.</p>
                </div>
                <div class="flex gap-3">
                    <button onclick="prevWash()" class="flex-1 py-3 rounded-xl bg-gray-100 text-gray-600">PrÃ©cÃ©dent</button>
                    <button onclick="nextWash()" class="flex-1 py-3 rounded-xl bg-blue-600 text-white font-medium shadow-lg shadow-blue-200">Suivant</button>
                </div>
            </div>
        </div>

        <!-- ONGLET 4: FLASHCARDS -->
        <div id="tab-flashcards" class="hidden fade-in h-[400px] flex flex-col">
            <div class="flex justify-between items-center mb-4 px-2">
                <h2 class="font-bold text-gray-800">RÃ©vision Express</h2>
                <span class="bg-gray-200 text-gray-600 text-xs px-2 py-1 rounded-full font-bold" id="fc-count">1 / 4</span>
            </div>

            <div class="flex-1 relative perspective-1000 cursor-pointer group" onclick="flipCard()">
                <div id="flashcard-inner" class="w-full h-full transition-transform duration-500 transform-style-3d relative rounded-3xl shadow-xl">
                    <!-- FRONT -->
                    <div class="absolute inset-0 bg-white rounded-3xl p-8 flex flex-col items-center justify-center text-center backface-hidden border-2 border-gray-100">
                        <span class="bg-emerald-100 text-emerald-800 text-xs font-bold px-3 py-1 rounded-full mb-6">QUESTION</span>
                        <p class="text-xl font-medium text-gray-800 leading-relaxed" id="fc-q">Qu'est-ce que la 'Awrah ?</p>
                        <p class="text-gray-400 text-xs mt-8 animate-pulse">Toucher pour voir la rÃ©ponse</p>
                    </div>
                    <!-- BACK -->
                    <div class="absolute inset-0 bg-emerald-600 rounded-3xl p-8 flex flex-col items-center justify-center text-center backface-hidden rotate-y-180">
                        <span class="bg-emerald-800 text-emerald-100 text-xs font-bold px-3 py-1 rounded-full mb-6">RÃ‰PONSE</span>
                        <p class="text-xl font-medium text-white leading-relaxed" id="fc-a">Les parties du corps qu'Allah a interdit de dÃ©voiler aux autres.</p>
                    </div>
                </div>
            </div>

            <button onclick="nextCard()" class="mt-6 w-full py-4 bg-gray-900 text-white rounded-2xl font-medium flex items-center justify-center gap-2 hover:bg-black transition-colors">
                Question Suivante
            </button>
        </div>

    </main>

    <!-- CHATBOT -->
    <div class="fixed bottom-24 right-4 z-50">
        <button id="chat-toggle" onclick="toggleChat()" class="bg-emerald-600 hover:bg-emerald-700 text-white p-4 rounded-full shadow-lg transition-transform hover:scale-105 flex items-center justify-center">
            <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M7.9 20A9 9 0 1 0 4 16.1L2 22Z"/></svg>
        </button>
    </div>

    <div id="chat-window" class="hidden fixed bottom-24 right-4 w-80 bg-white rounded-2xl shadow-2xl border border-gray-100 overflow-hidden z-50 slide-up flex flex-col h-[400px]">
        <div class="bg-emerald-600 p-4 flex justify-between items-center text-white">
            <span class="font-bold text-sm flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z"/><path d="M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z"/></svg>
                Assistant Fiche 8
            </span>
            <button onclick="toggleChat()" class="hover:bg-white/20 p-1 rounded">X</button>
        </div>
        <div id="chat-messages" class="flex-1 bg-gray-50 p-4 overflow-y-auto space-y-3">
            <div class="flex justify-start">
                <div class="max-w-[85%] p-3 rounded-2xl text-sm bg-white text-gray-700 shadow-sm rounded-tl-none">
                    Assalamu alaykum. Je suis votre assistant. Une question ?
                </div>
            </div>
        </div>
        <form onsubmit="sendMessage(event)" class="p-3 bg-white border-t border-gray-100 flex gap-2">
            <input id="chat-input" type="text" placeholder="Votre question..." class="flex-1 bg-gray-100 rounded-full px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500">
            <button type="submit" class="bg-emerald-600 text-white p-2 rounded-full hover:bg-emerald-700">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>
            </button>
        </form>
    </div>

    <!-- NAVIGATION BAS -->
    <nav class="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 px-6 py-2 flex justify-between items-center z-40 pb-safe max-w-md mx-auto">
        <button onclick="switchTab('definitions')" id="nav-definitions" class="nav-btn flex flex-col items-center gap-1 p-2 text-emerald-700 -translate-y-1 transition-all">
            <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>
            <span class="text-[10px] font-medium">DÃ©finitions</span>
        </button>
        <button onclick="switchTab('simulateur')" id="nav-simulateur" class="nav-btn flex flex-col items-center gap-1 p-2 text-gray-400 hover:text-gray-600 transition-all">
            <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
            <span class="text-[10px] font-medium">Simulateur</span>
        </button>
        <button onclick="switchTab('mauvais-oeil')" id="nav-mauvais-oeil" class="nav-btn flex flex-col items-center gap-1 p-2 text-gray-400 hover:text-gray-600 transition-all">
            <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
            <span class="text-[10px] font-medium">M. Å’il</span>
        </button>
        <button onclick="switchTab('flashcards')" id="nav-flashcards" class="nav-btn flex flex-col items-center gap-1 p-2 text-gray-400 hover:text-gray-600 transition-all">
            <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z"/><path d="M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z"/></svg>
            <span class="text-[10px] font-medium">Quiz</span>
        </button>
    </nav>

    <!-- LOGIQUE JAVASCRIPT -->
    <script>
        // --- NAVIGATION TABS ---
        function switchTab(tabId) {
            // Cacher tous les onglets
            document.querySelectorAll('#main-content > div').forEach(el => el.classList.add('hidden'));
            // Afficher le bon
            document.getElementById('tab-' + tabId).classList.remove('hidden');
            
            // Reset boutons nav
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('text-emerald-700', '-translate-y-1');
                btn.classList.add('text-gray-400');
            });
            // Activer le bon bouton
            const activeBtn = document.getElementById('nav-' + tabId);
            activeBtn.classList.remove('text-gray-400');
            activeBtn.classList.add('text-emerald-700', '-translate-y-1');
        }

        // --- SIMULATEUR ---
        let simConfig = { subject: 'homme', target: 'homme', relation: 'ajnabi' };
        
        function updateSim(key, val) {
            simConfig[key] = val;
            
            // UI Boutons
            document.querySelectorAll(`#btn-${key.substring(0,3)}-homme, #btn-${key.substring(0,3)}-femme, #btn-${key.substring(0,3)}-ajnabi, #btn-${key.substring(0,3)}-mahram`).forEach(btn => {
                btn.classList.remove('bg-emerald-600', 'text-white', 'border-emerald-600');
                btn.classList.add('bg-white', 'text-gray-500', 'border-gray-200');
            });
            const activeBtn = document.getElementById(`btn-${key.substring(0,3)}-${val}`);
            activeBtn.classList.remove('bg-white', 'text-gray-500', 'border-gray-200');
            activeBtn.classList.add('bg-emerald-600', 'text-white', 'border-emerald-600');

            // Logique
            let text = "";
            let isDanger = false;
            
            if (simConfig.subject === 'homme') {
                if (simConfig.target === 'homme') {
                    text = "Entre hommes : La 'Awrah est situÃ©e entre le nombril et les genoux.";
                } else {
                    if (simConfig.relation === 'mahram') {
                        text = "Face Ã  une Mahram : La 'Awrah est du nombril aux genoux (pour l'homme).";
                    } else {
                        text = "Face Ã  une Ã©trangÃ¨re (Ajnabiyyah) : Tout le corps est 'Awrah sauf tÃªte et extrÃ©mitÃ©s.";
                        isDanger = true;
                    }
                }
            } else { // Femme
                if (simConfig.target === 'femme') {
                    text = "Entre femmes : La 'Awrah est situÃ©e entre le nombril et les genoux.";
                } else {
                    if (simConfig.relation === 'mahram') {
                        text = "Face Ã  un Mahram : Tout le corps est 'Awrah sauf visage, tÃªte, cou, mains et pieds.";
                    } else {
                        text = "Face Ã  un Ã©tranger (Ajnabi) : TOUT le corps est 'Awrah sauf visage et mains.";
                        isDanger = true;
                    }
                }
            }

            // Affichage RÃ©sultat
            const box = document.getElementById('sim-result-box');
            const txt = document.getElementById('sim-text');
            txt.innerText = text;
            if(isDanger) {
                box.className = "p-5 rounded-2xl border bg-red-50 text-red-800 border-red-200 shadow-sm flex items-start gap-3";
            } else {
                box.className = "p-5 rounded-2xl border bg-emerald-50 text-emerald-800 border-emerald-200 shadow-sm flex items-start gap-3";
            }
        }

        // --- MAUVAIS OEIL ---
        function showMoStep(step) {
            document.getElementById('mo-step-0').classList.add('hidden');
            document.getElementById('mo-step-1').classList.add('hidden');
            document.getElementById('mo-step-2').classList.add('hidden');
            document.getElementById('mo-step-' + step).classList.remove('hidden');
        }

        const washes = [
            "Se rincer la bouche (Madmadah) et recracher dans le bol.",
            "Laver le visage au-dessus du bol.",
            "Laver la main droite, puis la gauche.",
            "Laver le coude droit, puis le gauche.",
            "Laver le genou droit, puis le gauche.",
            "Laver les extrÃ©mitÃ©s des pieds.",
            "Laver l'intÃ©rieur du vÃªtement (Izar).",
            "Verser toute l'eau sur la tÃªte du malade par derriÃ¨re."
        ];
        let washIdx = 0;
        
        function nextWash() {
            washIdx = (washIdx + 1) % washes.length;
            updateWashUI();
        }
        function prevWash() {
            if(washIdx > 0) washIdx--;
            updateWashUI();
        }
        function updateWashUI() {
            document.getElementById('wash-text').innerText = washes[washIdx];
            document.getElementById('wash-count').innerText = (washIdx + 1) + "/" + washes.length;
        }

        // --- FLASHCARDS ---
        const cards = [
            { q: "Qu'est-ce que la 'Awrah ?", a: "Les parties du corps qu'Allah a interdit de dÃ©voiler aux autres." },
            { q: "Awrah de l'homme face Ã  un homme ?", a: "Entre le nombril et les genoux." },
            { q: "Mon cousin est-il Mahram ?", a: "NON. C'est un Ajnabi (Ã©tranger) car le mariage est possible." },
            { q: "Quel est le remÃ¨de si on connaÃ®t l'auteur du mauvais Å“il ?", a: "Il doit faire les ablutions spÃ©cifiques et on verse l'eau sur le malade." }
        ];
        let cardIdx = 0;
        let isFlipped = false;

        function flipCard() {
            const inner = document.getElementById('flashcard-inner');
            if(isFlipped) {
                inner.classList.remove('rotate-y-180');
            } else {
                inner.classList.add('rotate-y-180');
            }
            isFlipped = !isFlipped;
        }

        function nextCard() {
            // Reset flip
            const inner = document.getElementById('flashcard-inner');
            inner.classList.remove('rotate-y-180');
            isFlipped = false;
            
            // Change text after animation
            setTimeout(() => {
                cardIdx = (cardIdx + 1) % cards.length;
                document.getElementById('fc-q').innerText = cards[cardIdx].q;
                document.getElementById('fc-a').innerText = cards[cardIdx].a;
                document.getElementById('fc-count').innerText = (cardIdx + 1) + " / " + cards.length;
            }, 300);
        }

        // --- CHATBOT ---
        function toggleChat() {
            const win = document.getElementById('chat-window');
            const btn = document.getElementById('chat-toggle');
            if(win.classList.contains('hidden')) {
                win.classList.remove('hidden');
                btn.classList.add('hidden');
            } else {
                win.classList.add('hidden');
                btn.classList.remove('hidden');
            }
        }

        function sendMessage(e) {
            e.preventDefault();
            const input = document.getElementById('chat-input');
            const txt = input.value.trim();
            if(!txt) return;

            // User msg
            const box = document.getElementById('chat-messages');
            box.innerHTML += `<div class="flex justify-end"><div class="max-w-[85%] p-3 rounded-2xl text-sm bg-emerald-600 text-white rounded-tr-none">${txt}</div></div>`;
            input.value = "";
            box.scrollTop = box.scrollHeight;

            // Bot reply
            setTimeout(() => {
                box.innerHTML += `<div class="flex justify-start"><div class="max-w-[85%] p-3 rounded-2xl text-sm bg-white text-gray-700 shadow-sm rounded-tl-none">C'est notÃ©. RÃ©fÃ©rez-vous Ã  la section DÃ©finitions pour plus de dÃ©tails.</div></div>`;
                box.scrollTop = box.scrollHeight;
            }, 1000);
        }
    </script>
</body>
</html>
